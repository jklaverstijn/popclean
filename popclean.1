.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.14
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "POPCLEAN 1"
.TH POPCLEAN 1 "2004-09-30" "perl v5.8.3" "User Contributed Perl Documentation"
.SH "NAME"
popclean \- script to purge messages at a POP3 server older than a certain age, larger than a given size or tagged by a spamfilter.
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBpopclean\fR [options]
.PP
Options:
.PP
.Vb 21
\& -a, --maxage                      Set maximum age in hours before a message is purged
\& -l, --limit                       Messages larger than this limit in KB will be deleted
\& -g, --spamtag                     Messages with this text in the subject will be considered tagged as spam and will be deleted
\& -f, --fetchmailrc=file            Specify an alternate name for the fetchmail run control file
\& -i, --uidlfile=file               Specify an alternate name for the .fetchids file
\& -k, --skipuidl                    Bypass verification of .fetchids file
\& -u, --user                        Specify username
\& -p, --password                    Specify password
\& -s, --server                      Specify POP3 server name or IP address
\& -t, --test-mode, --test           Operate as normal but do not actually purge messages
\& -S, --syslog                      Write messages to syslog daemon
\& -T, --timeout                     Set timeout in seconds for connecting to the POP server
\& --attempts                        Number of attempts before giving up on connecting to a server
\& -P, --port                        The POP server port number
\& -A, --authmode                    Authentication method. Use BEST (default), APOP, CRAM-MD5 or PASS.
\& -v, --verbose                     Write details about deleted messages
\& -d, --debug                       Write detailed information while processing messages
\& -F, --force                       Purge messages even with unrecognisable date
\& -V, --version                     Print version
\& -?, --usage                       Print usage message
\& -h, --help                        Print documentation
.Ve
.SH "OPTIONS"
.IX Header "OPTIONS"
.IP "\fB\-A\fR, \fB\-\-maxage\fR N" 4
.IX Item "-a, --maxage N"
Any message older than N hours will be deleted. If \-\-maxage=0 is specified
the age will be ignored. This is useful when deletion based upon size 
is intended. Default: 48
.IP "\fB\-l\fR, \fB\-\-limit\fR N" 4
.IX Item "-l, --limit N"
Any message larger than N Kbytes will be deleted. If limit=0 is 
specified the size will be ignored. This is the default behaviour.
If \-\-limit and \-\-maxage are combined they are \s-1OR\s0'ed. This means a message 
needs to exceed either \-\-limit or \-\-maxage to be deleted.
.IP "\fB\-g\fR, \fB\-\-spamtag\fR <tag>" 4
.IX Item "-g, --spamtag <tag>"
Specifies a string that, if present in the subject line, causes the message
to be deleted from the server. Spamfilters often add a special tag to the
subject of a message to indicate it is considered spam. If \-\-spamtag and 
\&\-\-maxage are combined they are \s-1OR\s0'ed. This means a message needs to exceed
either \-\-maxage or be considered spam to be deleted.
.IP "\fB\-V\fR, \fB\-\-version\fR" 4
.IX Item "-V, --version"
Displays the version information for your copy of popclean.
No further actions are performed.
.IP "\fB\-u\fR, \fB\-\-user\fR <username>" 4
.IX Item "-u, --user <username>"
The \fB\-u\fR parameter will cause popclean to process a specific user
account.  This requires the server name or address to be specified
as well.
.IP "\fB\-s\fR, \fB\-\-server\fR <servername or address>" 4
.IX Item "-s, --server <servername or address>"
Specifies the host name or dotted \s-1IP\s0 address of the \s-1POP3\s0 server.
This option is required if \fB\-u\fR is given.
.IP "\fB\-p\fR, \fB\-\-password\fR <password>" 4
.IX Item "-p, --password <password>"
Specifies the cleartext password belonging to the user account
as specified by \fB\-u\fR and \fB\-s\fR.  If no password is specified but
the \fB\-u\fR and \fB\-s\fR options are present, the user is prompted to
specify one.
.IP "\fB\-P\fR, \fB\-\-port\fR <portnum>" 4
.IX Item "-P, --port <portnum>"
Specifies the \s-1POP\s0 server port (default = 110). This value overrides
the value specified in the fetchmailrc file.
.IP "\fB\-A\fR, \fB\-\-authmode\fR <mode>" 4
.IX Item "-A, --authmode <mode>"
Authentication mode used to login to the \s-1POP\s0 server. If the mode is set
to \s-1BEST\s0, and the server appears to support \s-1APOP\s0, it will try \s-1APOP\s0, if
that fails, then it will try \s-1SASL\s0 \s-1CRAM\-MD5\s0 if the server appears to
support it, and finally \s-1PASS\s0. If the mode is set to \s-1APOP\s0, and the server
appears to support \s-1APOP\s0, it will use \s-1APOP\s0 or it will fail to log in.
Likewise, for \s-1CRAM\-MD5\s0, no PASS-fallback is made. Otherwise password is
sent in clear text.
.IP "\fB\-T\fR, \fB\-\-timeout\fR <seconds>" 4
.IX Item "-T, --timeout <seconds>"
The timeout option (default = 60 seconds) allows you to set a
server-nonresponse timeout in seconds. After the timeout expires
the connection is considered dead. This value overrides the value
specified in the fetchmailrc file.
.IP "\fB\-\-attempts\fR <number>" 4
.IX Item "--attempts <number>"
Number of attempts (default=3) to connect to a server. Sometimes the
first attempt to connect to a server fails for unknown reasons, usually
network related. This option allows the control of the number of
retries. Authorization failures are never retried.
.IP "\fB\-f\fR, \fB\-\-fetchmailrc\fR <filename>" 4
.IX Item "-f, --fetchmailrc <filename>"
Specify the location of the fetchmail configuration file> By
default popclean will look for the file \fB$HOME/.fetchmailrc\fR.
Many options and directives are ignored. The following options are 
actually used: server, username, password, port, timeout.
When account information is explicitly specified through the
\&\-\-user option this file is ignored. See the \s-1README\s0 file for details.
.IP "\fB\-i\fR, \fB\-\-uidlfile\fR <filename>" 4
.IX Item "-i, --uidlfile <filename>"
Specify an alternate name for the .fetchids file used by fetchmail to
save \s-1POP3\s0 UIDs.  By default the file \fB$HOME/.fetchids\fR is read to
validate \s-1POP3\s0 UIDs to make shure that fetchmail has fetched a message
before deciding to delete it. This prevents deletion of messages when
fetchmail has not run for a period longer than \s-1MAXAGE\s0. This value
overrides the value specified in the fetchmailrc file.
.IP "\fB\-k\fR, \fB\-\-skipuidl\fR" 4
.IX Item "-k, --skipuidl"
Bypass validation of UIDs against the .fetchids file. Beware of the
danger of unwanted deletion if fetchmail has not run in a while. This
option is useful if fetchmail is not around (in this case also use
\&\-\-user, \-\-password and \-\-server) or is not using the \s-1UIDL\s0 option for
some reason.
.IP "\fB\-t\fR, \fB\-\-test\-mode\fR, \fB\-\-test\fR" 4
.IX Item "-t, --test-mode, --test"
Popclean will work normally but will not actually delete any messages.
This is especially useful for testing purposes.
.IP "\fB\-S\fR, \fB\-\-syslog\fR" 4
.IX Item "-S, --syslog"
This option allows you to redirect status and error messages emitted
to the \fIsyslog\fR\|(3) system daemon if available. Messages are logged with
an id of popclean, the facility \s-1LOG_MAIL\s0, and priorities \s-1LOG_ERR\s0,
\&\s-1LOG_ALERT\s0 or \s-1LOG_INFO\s0. This option is intended for logging status
and error messages which indicate the results while cleaning a \s-1POP\s0
account. Error messages for command line options and parsing the
configuration file are still written to stderr.
.IP "\fB\-v\fR, \fB\-\-verbose\fR" 4
.IX Item "-v, --verbose"
Verbose mode. Information about processed messages is echoed to
the output.
.IP "\fB\-d\fR, \fB\-\-debug\fR" 4
.IX Item "-d, --debug"
Debug mode. Implies verbose mode. Echoes extra diagnostic information
about all messages. In particular the conversation with the \s-1POP3\s0
server echoed. Warning: This can cause lots of output when many
messages and/or many accounts are processed.
.IP "\fB\-F\fR, \fB\-\-force\fR" 4
.IX Item "-F, --force"
Forced deletion of messages. Sometimes the age of a message cannot
be determined due to malformed date headers. With this option these
messages are always deleted. Beware: this can lead to deletion of
recent messages.
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Fetchmail downloads (\*(L"fetches\*(R") messages from a \s-1POP3\s0 mailserver and
forwards them your local (client) machine's delivery system using \s-1SMTP\s0.
It can either leave a copy of these messages on that server or delete
them entirely. Many users of fetchmail have requested the possibility to
postpone that deletion to a later date. Every single user has different
reasons for that request. As per the \s-1FAQ\s0 (see
http://catb.org/~esr/fetchmail/fetchmail\-FAQ.html), item G5, fetchmail
is not meant to implement policy; hence the second-most-requested
feature for fetchmail is denied. Popclean comes to the rescue.
.PP
Popclean is a perl script that deletes messages from a \s-1POP3\s0 server a
certain amount of time after they have been received by that server. It
does so by looking at the latest \*(L"Received:\*(R" header. It was designed to
work in conjunction with fetchmail. By default, account information is
obtained from the fetchmail configuration. Popclean will also look at
the .fetchids file to determine if a message was received by the local
host before deleting it from the \s-1POP\s0 server. This helps in avoiding
deletion of unread messages.
.PP
Additionally, popclean can delete messages that exceed a certain size
or contain a tag in the subject line that was inserted by a spamfilter.
.PP
Provided the correct set of
arguments was specified no Fetchmail information is needed. Many options
control the behaviour of popclean. Some of them actually make the
presence of fetchmail optional.
.SH "ENVIRONMENT"
.IX Header "ENVIRONMENT"
No environment variables, aside from those used by perl, are required
to be set.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIfetchmail\fR\|(1)
.SH "AUTHOR"
.IX Header "AUTHOR"
Jan Klaverstijn <jan@klaverstijn.nl>
.SH "PREREQUISITES"
.IX Header "PREREQUISITES"
.IP "Mail::POP3Client" 4
.IX Item "Mail::POP3Client"
.PD 0
.IP "Mail::Header" 4
.IX Item "Mail::Header"
.IP "HTTP::Date" 4
.IX Item "HTTP::Date"
.IP "Sys::Syslog" 4
.IX Item "Sys::Syslog"
